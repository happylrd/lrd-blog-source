---
title: 函数式编程教程
date: 2017-07-22 20:36:21
tags:
- 函数式编程
categories:
- 技术向
thumbnail: http://cdn.happylrd.com/image/fp_bg.jpg
---

> 杨柳青青江水平，闻郎江上踏歌声。东边日出西边雨，道是无晴却有晴。
> <div style="text-align:right"><p>——《<cite>竹枝词二首·其一</cite>》</p></div>

## 引子

> todo

## 是什么

简而言之，FP（Functional Programming，函数式编程）是一种使用函数进行编程的方式。

FP 意味着 函数可以像任何其他值一样随意使用：可以作为参数传递，可以作为返回值，还能存储在数据结构中。能够像普通变量一样使用的函数称为一等函数（first-class function）。

在函数式编程的上下文中，一个“函数”对应于一个数学函数，它接受零个或多个参数，生成一个或多个结果，并且不会有任何副作用。

- 纯粹的函数式编程：无副作用
- 函数式编程：允许函数内部执行一些非函数式的操作，只要这些操作的结果不会暴露给系统中的其他部分。换句话说，程序有一定的副作用，不过该副作用不会为其他的调用者所感知。

### 无副作用

简而言之，副作用就是函数的效果已经超出了函数自身的范畴。

造成副作用的一些因素
- 除了构造器内的初始化操作，对类中数据结构的任何修改，包括字段的赋值操作（如setter方法）
- 抛出一个异常
- 进行 IO（输入/输出） 操作，比如向一个文件写数据

如果一个方法既不修改它内嵌类的状态，也不修改其他对象的状态，使用`return`返回所有的计算结果，则称其为无副作用的（或纯粹的）。

不可变对象是 一旦完成初始化就不会被任何方法修改状态 的一种对象。这意味着一旦一个不可变对象初始化完毕，它永远不会进入到一个无法预期的状态，从而可以放心地共享它，无需保留任何副本，并且由于它们不会被修改，还是线程安全的。

如果构成系统的各个组件都能遵守“无副作用”这一原则，该系统就能在完全无锁的情况下，使用多核的并发机制，因为任何一个方法都不会对其他的方法造成干扰。

### 声明式编程

> 你只需要使用不相互影响的表达式，描述想要做什么，由系统来选择如何实现。

当开发一个系统时，一般有两种思考方式，即“如何做”与“做什么”。

- “如何做”风格的编程也被称为命令式编程，如 OOP
- “做什么”风格的编程被称为声明式编程，如 FP

### 引用透明性

“没有可感知的副作用”（不改变对调用者可见的变量、不进行I/O、不抛出异常）的这些限制都隐含着 *引用透明性*。

如果一个函数只要传递相同的参数值，总是返回相同的结果，那它就是引用透明的。

### 高阶函数

如果函数能满足以下任一要求，它就可以被称为高阶函数（higher-order function）
- 接受至少一个函数作为参数
- 返回的结果是一个函数

### 柯里化

它是一种可以帮助你模块化函数、提高代码重用性的技术。

## 为什么

从长远看，减少共享的可变数据结构能有效降低维护和调试程序的代价。

## FP与Java

- 尽量使用 `Stream` 取代迭代操作，从而避免变化带来的影响。
- 如果递归能让你以更精炼、并且不带任何副作用的方式实现算法，你就应该用递归替换迭代
- 很多时候，编程的效率要比细微的执行时间差异重要得多
